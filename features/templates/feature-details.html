{% extends 'base.html' %}

{% load bootstrap_tags %} 

{% block page_title %} Current Features {% endblock %} 

{% block search %}
<form class="form-inline form-right text-right my-2 my-lg-0" action="{% url 'search-bugs' %}">
    <div class="wrap-fields">
        <input class="form-control mr-sm-2 w-100" name="search" type="search" placeholder="Search" aria-label="Search">
        <button class="btn my-2 my-sm-0 search-icon" type="submit"><i class="fas fa-search"></i></button>
    </div>
</form>
{% endblock %} {% block content %}
<!--NEW CARD-->
<div class="card mt-3 mb-4">
    <div class="card-header">
        <span class="custom-size font-weight-bold d-inline">{{ feature.name }}</span>
        
        {% if feature.target_value == 0 %}
        <div class="col-12 col-sm-5 d-sm-inline p-0">
        <span class="float-right pl-2"><i class="fas fa-eye">{{ views }}</i></span>
        <span class="badge badge-pill badge-secondary d-inline d-sm-auto float-sm-right  custom-size">
        Pending Asessment</span>
        </div>
        
        {% elif feature.target_value <= feature.value_collected %}
        <span class="badge badge-pill badge-success float-left float-sm-right custom-size">
        Implementation in progress
        </span>
        <span class="pl-2"> <i class="fas fa-eye pr-2"> {{ views }}</i></span>
        {% elif feature.target_value != 0 %}
        <span class="badge badge-pill badge-info float-left float-sm-right custom-size">
        Funding required
        </span>
        {% endif %}
        
    </div>
    
    <div class="card-body">
        <div class="row">
        <blockquote class="blockquote mb-1 col-lg-9">
            <p>{{ feature.description }}</p>
            <footer class="blockquote-footer list-inline"> Added {{ feature.date_reported | date}} by
                <li class="d-inline"><img class="rounded-circle profile-image" src="{{ feature.author.profile.image.url  }}"></img>
                   <span>{{ feature.author }}</span>
                </li>
            </footer>
            </blockquote>
        <!---->
         <div class="float-left float-lg-right">
            <span class="float-left"><strong>{{ feature.value_collected}}£ </strong>Collected</span>
            <span>.</span>
            <span class="float-right"><strong>{{ feature.target_value }}£</strong> Required</span>
            <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: {{ progress }}%" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100">
                    {% if remaining <= 0 %}
                    Completed 
                    {% else %} 
                    {{ progress|floatformat:1}}% 
                    </div>
                    {% endif %}
                    <p class="d-inline ml-4 float-right"> <strong>{{ remaining|floatformat:2 }}</strong>£ Remaining </p>
                </div>
            </div>
        <!---->
        </div>
        </div>
        </div>
        <div class="mt-2 mb-3">
                    <div class="ml-2" id="headingTwo">
                        <h5 class="mb-0">
                            <button class="btn btn-sm btn-info collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                              Contribute <i class="fas fa-user pl-2"> {{ contributors }}</i>
                            </button>
                            <hr>
                        </h5>
                    </div>
                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                    <div class="card-body">
                        <form class="w-25" method="post" action="{% url 'add_to_cart' feature.id %}">
                            {% csrf_token %} {{ contribute_form | as_bootstrap }}
                            <button type="submit" class="float-left btn btn-sm btn-success mb-2">Add to cart</button>
                        </form>
                    </div>
                </div>
    </div>

    <!--Contributions-->
    <div class="container mt-4">
        <div class="row">
    {% for contributor in contributor %}
    
    <div class="card col-md-4 d-inline">
  <div class="card-body">
    <h5 class="card-header"><img class="rounded-circle profile-image" src="{{ contributor.user.profile.image.url  }}"></img>{{ contributor.user }}</h5>
    <p class="card-text">Supported This feature with {{ contributor.amount }}</p>
    <blockquote class="blockquote mb-1">
                    <small>
                    Contribution registered on {{ contributor.date_contributed | date}}
                    </small>
                </blockquote>
  </div>
</div>
    {% endfor %}
    </div>
    </div>
    <!--END-->
    {% if contributors > 5 %}
    <!--Pagination-->
    <nav aria-label="Page navigation example">
        <ul class="pagination mt-3">
            {% if bugs.has_previous %}
            <li class="page-item"><a class="page-link" href="?page=1">&laquo; First</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ bugs.previous_page_number }}">Previous</a></li>
            {% endif %}
            <li><a class="page-link"> Page {{ bugs.number }} of {{ bugs.paginator.num_pages }}. </a> </li>
            {% if bugs.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ bugs.next_page_number }}">Next</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ bugs.paginator.num_pages }}">Last &raquo;</a></li>
            {% endif %}
        </ul>
    </nav>
    <!--END-->
    {% endif %}
    {% endblock %}
